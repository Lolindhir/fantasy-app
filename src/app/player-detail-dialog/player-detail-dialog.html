<h2 mat-dialog-title class="player-dialog-title">
  <div class="dialog-header">
    <img class="dialog-player-logo" [src]="player.Picture" alt="{{ player.TeamNFL.Name }}" />

    <div class="dialog-player-info">
      <span class="dialog-player-name">{{ player.Name }}</span>
      <div *ngIf="rankingCombined != undefined" class="dialog-rankings">
        <span>#{{ rankingCombined }} <small>Overall</small></span>
        <span>#{{ rankingCombinedPosition }} <small>Pos</small></span>
      </div>
    </div>

    <button mat-icon-button (click)="close()" class="dialog-close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</h2>

<mat-dialog-content class="dialog-content">

  <!-- 🏈 Overview Tab -->
  <mat-tab-group>
    <mat-tab label="Overview">
      <div class="dialog-overview">

        <div class="dialog-info">

          <div class="dialog-team">
            <img *ngIf="player.TeamNFL?.Logo" [src]="player.TeamNFL.Logo" alt="Logo" class="dialog-team-logo" />
            <span>{{ player.TeamNFL.Name }} ({{ player.Position }} #{{ player.Number }})</span>
          </div>

          <div class="dialog-player-details">
            <div *ngIf="player.TeamFantasy">
              <span class="label">Fantasy Team:</span>
              <strong>{{ player.TeamFantasy.Team }}</strong>
            </div>
            <div>
              <span class="label">Alter:</span> {{ player.Age }}
              <span class="label"> | Jahr:</span> {{ player.Year }}
            </div>
            <div>
              <span class="label">College:</span> {{ player.College }}
            </div>
            <div>
              <span class="label">Gehalt:</span> <strong>{{ player.SalaryDollarsDisplay }}</strong>
            </div>
            <div>
              <span class="label">Projiziert:</span> {{ player.SalaryDollarsProjectedDisplay }}
            </div>
          </div>

          <div class="dialog-status-chip">
            <mat-chip-listbox aria-label="Status">
              <mat-chip [color]="player.Injured ? 'warn' : 'primary'" selected>
                {{ player.Injured ? player.InjuryDetails.Designation : 'Active' }}
              </mat-chip>
            </mat-chip-listbox>
          </div>

        </div>
      </div>
    </mat-tab>

    <!-- 📊 Stats Tab -->
    <mat-tab label="Stats">
      <div class="dialog-stats-grid">
        <div><strong>Games Played:</strong> {{ player.Stats.GamesPlayed }}</div>
        <div><strong>Snaps Played:</strong> {{ player.Stats.SnapsTotal }}</div>
        <div><strong>Attempts:</strong> {{ player.Stats.AttemptsTotal }}</div>
        <div><strong>Fantasy Pts:</strong> {{ player.Stats.FantasyPointsTotal | number:'1.0-2' }}</div>
        <div><strong>Avg/Game:</strong> {{ player.Stats.FantasyPointsAvgGame | number:'1.1-2' }}</div>
        <div><strong>Total Touchdowns:</strong> {{ player.Stats.TouchdownsTotal | number }}</div>
        <div><strong>Receiving Touchdowns:</strong> {{ player.Stats.TouchdownsReceiving | number }}</div>
        <div><strong>Rushing Touchdowns:</strong> {{ player.Stats.TouchdownsRushing | number }}</div>
        <div><strong>Passing Touchdowns:</strong> {{ player.Stats.TouchdownsPassing | number }}</div>
      </div>

      <div class="stats-buttons">
        <a [href]="player.FantasyPros" target="_blank">FantasyPros</a>
        <a [href]="player.ESPN" target="_blank">ESPN</a>
      </div>
    </mat-tab>

    <!-- 📈 History Tab -->
    <mat-tab label="History">
      <div class="dialog-history-table">
        <table mat-table [dataSource]="getDefinedSeasons(player.Stats)">
          <ng-container matColumnDef="season">
            <th mat-header-cell *matHeaderCellDef>Season</th>
            <td mat-cell *matCellDef="let row">{{ row.Season }}</td>
          </ng-container>

          <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef>Total</th>
            <td mat-cell *matCellDef="let row">{{ row.Total }}</td>
          </ng-container>

          <ng-container matColumnDef="avgGame">
            <th mat-header-cell *matHeaderCellDef>Avg/Game</th>
            <td mat-cell *matCellDef="let row">{{ row.AvgGame }}</td>
          </ng-container>

          <ng-container matColumnDef="games">
            <th mat-header-cell *matHeaderCellDef>Games</th>
            <td mat-cell *matCellDef="let row">{{ row.GamesPlayed }}/{{ row.PotentialGames }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['season','total','avgGame','games']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['season','total','avgGame','games']"></tr>
        </table>
      </div>
    </mat-tab>

    <!-- 🩹 Injury Tab -->
    <mat-tab *ngIf="player.Injured && player.InjuryDetails" label="Injury">
      <div class="dialog-injury">
        <p><strong>{{ player.InjuryDetails.Description }}</strong></p>
        <p *ngIf="player.InjuryDetails.Designation"><strong>Designation:</strong> {{ player.InjuryDetails.Designation }}</p>
        <p *ngIf="player.InjuryDetails.ReturnDate"><strong>Expected Return Date:</strong> {{ player.InjuryDetails.ReturnDate | date }}</p>
      </div>
    </mat-tab>

  </mat-tab-group>
</mat-dialog-content>
